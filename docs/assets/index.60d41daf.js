const u=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function W(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=W(e);fetch(e.href,s)}};u();const f=r=>r.x<=1e3&&r.x>=0&&r.y<=1e3&&r.y>=0;class d{constructor(t){this.position=t}update(t){}draw(t,W){}keyboardEventDown(t){}keyboardEventUp(t){}}const l=r=>r*Math.PI/180,g="src/assets/ferrari.png";class p extends d{constructor(t){super(t.initialPos),this.angle=0,this.acceleration=0,this.initial_pos=t.initialPos,this.size=t.size,this.color=t.color||"blue",this.angleSpeed=t.angleSpeed||0,this.speed=typeof t.speed!="undefined"?t.speed:100,this.image=new Image,this.image.src=g}update(t){this.angle=this.angle+this.angleSpeed,this.speed=(this.speed+this.acceleration)*.98;const W={x:this.position.x+this.speed*t*Math.cos(l(this.angle)),y:this.position.y+this.speed*t*Math.sin(l(this.angle))};f(W)?this.position=W:this.speed=0}draw(t,W){W.translate(this.position.x,this.position.y),W.font="35px Consolas",W.fillStyle="#000",W.fillText(`${this.speed.toFixed(2)} px/seg`,0,60),W.fillStyle="#000",W.fillText(`x:${this.position.x.toFixed(0)} y:${this.position.y.toFixed(0)}`,0,100),W.rotate(l(this.angle)),W.rotate(l(180)),W.drawImage(this.image,-this.size.h/2,-this.size.w/2,this.size.h,this.size.w),W.fill()}keyboardEventDown(t){switch(t){case"ArrowRight":this.angleSpeed=2;break;case"ArrowLeft":this.angleSpeed=-2;break;case"ArrowUp":this.acceleration=10;break;case"ArrowDown":this.acceleration=-10;break;default:console.log("Not a valid key")}}keyboardEventUp(t){switch(t){case"ArrowUp":this.acceleration=0;break;case"ArrowDown":this.acceleration=0;break;case"ArrowRight":this.angleSpeed=0;break;case"ArrowLeft":this.angleSpeed=0;break;default:console.log("Not a valid key")}}restart_car(){this.position=this.initial_pos,this.angle=0,this.speed=0}}class b extends d{constructor(t,W,i){super(t.position),this.touched=!1,this.touching=!1,this.barrier_length=40,this.angle=0,this.car=W,this.angle=t.angle||0,this.linked_barrier=i}update(t){this.distance=Math.sqrt(Math.pow(this.position.x-this.car.position.x,2)+Math.pow(this.position.y-this.car.position.y,2)),this.distance<=this.barrier_length&&(this.linked_barrier?this.linked_barrier.touched&&(this.touched=!0):this.touched=!0),this.distance<=this.barrier_length?this.touching=!0:this.touching=!1}draw(t,W){var i;W.translate(this.position.x,this.position.y),W.rotate(l(this.angle)),W.fillStyle=this.touching?"green":"red",W.strokeStyle=this.touching?"green":"red",W.beginPath(),W.arc(0,0,10,0,2*Math.PI),W.closePath(),W.fill(),W.fillStyle=this.touched?"green":"red",W.strokeStyle=this.touched?"green":"red",W.beginPath(),W.moveTo(-this.barrier_length,0),W.lineTo(this.barrier_length,0),W.closePath(),W.stroke(),W.fillStyle="#000",W.font="35px Consolas",W.fillText(`${(i=this.distance)==null?void 0:i.toFixed(0)}`,0,0)}reset(){this.touched=!1}}class y extends d{constructor(t,W){super({x:800,y:35}),this.barriers=[],this.completed=!1,this.next_barrier_to_touch=0,this.current_touching=void 0;let i;this.car=W;for(let e=0;e<10;e++)i=new b({position:{x:t.x+e*80,y:t.y},angle:-90},W,i),this.barriers.push(i)}update(t){let W=0;for(let e=this.barriers.length;e<0;e--)this.barriers[e].touched&&W++;W==this.barriers.length&&(this.completed=!0),this.next_barrier_to_touch=0;for(let e=0;e<this.barriers.length&&this.barriers[e].touched;e++)this.next_barrier_to_touch=e;const i=this.barriers.findIndex(e=>e.touching);i!=-1&&(this.current_touching=i),typeof this.current_touching!="undefined"&&this.next_barrier_to_touch!=this.current_touching&&(console.log("BAD"),this.current_touching=void 0,this.car.restart_car(),this.barriers.forEach(e=>e.reset()))}draw(t,W){W.translate(this.position.x,this.position.y),W.font="35px Consolas",W.fillStyle="#000",W.fillText(this.completed?"COMPLETADO":"PENDIENTE",0,0),W.fillText(`CUR: ${this.current_touching} NEXT: ${this.next_barrier_to_touch}`,-100,30)}}let h=`WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
WW............WWW............WW
WW.WWWW.WWWWW.WWW.WWWWW.WWWW.WW
WW*WWWW.WWWWW.WWW.WWWWW.WWWW*WW
WW.WWWW.WWWWW.WWW.WWWWW.WWWW.WW
WW...........................WW
WW.WWWW.WW.WWWWWWWWW.WW.WWWW.WW
WW.WWWW.WW.WWWWWWWWW.WW.WWWW.WW
WW......WW....WWW....WW......WW
WWWWWWW.WWWWW.WWW.WWWWW.WWWWWWW
WWWWWWW.WWWWW.WWW.WWWWW.WWWWWWW
WWWWWWW.WW...........WW.WWWWWWW
WWWWWWW.WW.WWW---WWW.WW.WWWWWWW
WWWWWWW.WW.WoooooooW.WW.WWWWWWW
...........WoooooooW...........
WWWWWWW.WW.WoooooooW.WW.WWWWWWW
WWWWWWW.WW.WWWWWWWWW.WW.WWWWWWW
WWWWWWW.WW...........WW.WWWWWWW
WWWWWWW.WW.WWWWWWWWW.WW.WWWWWWW
WWWWWWW.WW.WWWWWWWWW.WW.WWWWWWW
WW............WWW............WW
WW.WWWW.WWWWW.WWW.WWWWW.WWWW.WW
WW*WWWW.WWWWW.WWW.WWWWW.WWWW*WW
WW...WW.................WW...WW
WWWW.WW.WW.WWWWWWWWW.WW.WW.WWWW
WWWW.WW.WW.WWWWWWWWW.WW.WW.WWWW
WW......WW....WWW....WW......WW
WW.WWWWWWWWWW.WWW.WWWWWWWWWW.WW
WW.WWWWWWWWWW.WWW.WWWWWWWWWW.WW
WW...........................WW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW`.split(`
`).map(r=>r.split(""));class w extends d{constructor(t,W,i,e,s,o){super(t),this.canvasWidth=W.canvas.width,this.canvasHeight=W.canvas.height,this.purple=i,this.black=e,this.green=s,this.white=o}keyboardEventDown(){}keyboardEventUp(){}update(){}draw(t,W){let i=this.canvasHeight/h.length;for(let e=0;e<h.length;e++)for(let s=0;s<h[e].length;s++){switch(W.beginPath(),h[e][s]){case"W":W.fillStyle=this.purple,W.fillRect(s*i,e*i,i,i),W.fill();break;case".":W.fillStyle=this.black,W.arc(s*i+i/2,e*i+i/2,5,0,2*Math.PI),W.fill();break;case"*":W.fillStyle=this.green,W.arc(s*i+i/2,e*i+i/2,5,0,2*Math.PI),W.fill();break;case"-":W.fillStyle=this.white,W.fillRect(s*i,e*i,i,i),W.fill();break;case"o":W.fillStyle=this.black,W.fillRect(s*i,e*i,i,i),W.fill();break}W.closePath()}}}window.onload=()=>{const r=document.getElementById("canvas"),t=r.getContext("2d"),W=new p({initialPos:{x:500,y:467},size:{w:50,h:100},speed:0});new y({x:200,y:500},W);let e=[new w({x:0,y:0},t,"purple","black","green","white"),W],s=0;const o=a=>{let n=(a-s)/1e3;s=a,e.forEach(c=>c.update(n)),t.clearRect(0,0,r.width,r.height),e.forEach(c=>{t.save(),c.draw(n,t),t.restore()}),window.requestAnimationFrame(o)};window.requestAnimationFrame(o),document.body.addEventListener("keydown",a=>{e.forEach(n=>n.keyboardEventDown(a.key))}),document.body.addEventListener("keyup",a=>{e.forEach(n=>n.keyboardEventUp(a.key))})};
